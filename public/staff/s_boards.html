<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Trackboard</title>
    <!-- <meta content="" name="descriptison">
    <meta content="" name="keywords"> -->
    
    <!-- Favicons -->
    <!-- <link href="" rel="icon">
    <link href="" rel="apple-touch-icon"> -->

    
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <!-- <script src="..\assets\vendor\jquery\jquery.min.js"></script> -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/vendor/icofont/icofont.min.css">
    <link rel="stylesheet" href="../assets/vendor/boxicons/css/boxicons.min.css">
    <link rel="stylesheet" href="../assets/vendor/animate.css/animate.min.css">
    <link rel="stylesheet" href="../assets/vendor/venobox/venobox.css">
    <link rel="stylesheet" href="../assets/vendor/owl.carousel/assets/owl.carousel.min.css">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.12.0/css/all.css">
    <link href="https://fonts.googleapis.com/css?family=Bonbon&display=swap" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="sidebar-style.css"/>


    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script>
      $(function(){
        $("#header").load("../include/staff_header.html"); 
        $("#footer").load("../include/staff_footer.html"); 
      });
    </script> 
  </head>
  <body>
    <!-- Run 'firebase serve' and open localhost to see header and footer, otherwise you get CORS error  -->
    <div id="header"></div>


    <button class="openbtn" id="openbtn" onclick="openNav()">
      â˜°
    </button>
    <div id="mySidebar" class="sidebar">
      <a href="javascript:void(0)" class="closebtn" onclick="closeNav()"> x </a>
      <a href="./s_requests.html">Poster Requests</a>
      <a href="./s_map.html">Campus Map</a>
      <a href="./s_boards.html">Boards</a>
      <a href="./s_rules.html">Edit Poster Rules</a>
    </div>

    <div id="main_content" style="min-width: 1090px; display: flex; padding: 10px;">
      <!-- ======= Boards Section ======= -->
      <section id="portfolio" class="portfolio">
        <div class="container">

          <div class="section-title">
            <h2>BOARDS</h2>
            <p>Sit sint consectetur velit quisquam cupiditate impedit suscipit</p>
          </div>

          <!-- TODO DYNAMICALLY LOAD CONTENT !! Below is an example -->
          <div id="dropdownList">

          </div>

            <!-- TODO DYNAMICALLY LOAD CONTENT !! Below is an example -->
          <div id="posterBoardViewer" class="row portfolio-container" style="width: 1020px; min-height: 720px; max-height: 720px; margin: 10px; background-color: #aaff99; overflow-y:scroll; display: flex; justify-content: flex-start;"> 
          </div>

          </div>
        </div>
      </section><!-- End Portfolio Section -->


      <div id="footer"></div>
    </div>


    <!-- Template Main JS File -->
    <!-- <script src="../assets/js/main.js"></script> -->

    
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.14.4/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.14.4/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.4/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.4/firebase-firestore.js"></script>

    <!-- <script src="../include/init_firebase.js"></script> -->
    <script>
        // Your web app's Firebase configuration
      var firebaseConfig = {
        apiKey: "AIzaSyBveio8IuFGOMymSnwNgAWqc14BVliUwHY",
        authDomain: "trackboard-d41a2.firebaseapp.com",
        databaseURL: "https://trackboard-d41a2.firebaseio.com",
        projectId: "trackboard-d41a2",
        storageBucket: "trackboard-d41a2.appspot.com",
        messagingSenderId: "880705427344",
        appId: "1:880705427344:web:43e253a149143cc9218515",
        measurementId: "G-5GLK0MX33D",
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();

      // var st = firebase.storage();
      var db = firebase.firestore();
    </script>

    <script>

      // var bfl = [];
      var bfl = [
        { building_id: "bd1", building_name: "Building A",
          floors: [
            { floor_id: "fl1", floor_name: "Main Floor",
              locations: [
                { location_id: "lc1", location_name: "Lounge" },
                { location_id: "lc2", location_name: "Student Service Office" },
              ]
            },
            { floor_id: "fl2", floor_name: "4th Floor",
              locations: [
                { location_id: "lc3", location_name: "Main Board" },
                { location_id: "lc4", location_name: "President Office" },
              ]
            }
          ]
        },
        { building_id: "bd2", building_name: "Building B",
          floors: [
            { floor_id: "fl3", floor_name: "MEOW Floor",
              locations: [
                { location_id: "lc5", location_name: "Lazy pool" },
                { location_id: "lc6", location_name: "Jacuzzi" },
              ]
            },
            { floor_id: "fl4", floor_name: "BLUB Floor",
              locations: [
                { location_id: "lc7", location_name: "Everland" },
                { location_id: "lc8", location_name: "Lotte World" },
              ]
            }
          ]
        },
        { building_id: "bd3", building_name: "Building C",
          floors: [
            { floor_id: "fl5", floor_name: "Main Floor",
              locations: [
                { location_id: "lc9", location_name: "Sleeping Spot" },
                { location_id: "lc10", location_name: "Tired Corner" },
              ]
            },
            { floor_id: "fl6", floor_name: "4th Floor",
              locations: [
                { location_id: "lc11", location_name: "Wall1" },
                { location_id: "lc12", location_name: "Wall2" },
              ]
            }
          ]
        }
      ];
      // var myPosters = [];
      var myPosters = [
        { building_id: "bd1", floor_id: "fl1", location_id: "lc1",
          image_link: "../assets/img/posters/poster-1.jpg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc1",
          image_link: "../assets/img/posters/poster-2.jpg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc1",
          image_link: "../assets/img/posters/poster-3.jpg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc1",
          image_link: "../assets/img/posters/poster-4.jpg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc1",
          image_link: "../assets/img/posters/poster-5.jpg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc1",
          image_link: "../assets/img/posters/poster-6.jpg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc2",
          image_link: "../assets/img/posters/poster-7.jpeg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc2",
          image_link: "../assets/img/posters/poster-8.jpg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc2",
          image_link: "../assets/img/posters/poster-9.jpg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc2",
          image_link: "../assets/img/posters/poster-10.jpg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc2",
          image_link: "../assets/img/posters/poster-11.jpg"
        },
        { building_id: "bd1", floor_id: "fl1", location_id: "lc2",
          image_link: "../assets/img/posters/poster-12.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc3",
          image_link: "../assets/img/posters/poster-13.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc3",
          image_link: "../assets/img/posters/poster-14.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc3",
          image_link: "../assets/img/posters/poster-15.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc3",
          image_link: "../assets/img/posters/poster-16.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc3",
          image_link: "../assets/img/posters/poster-17.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc3",
          image_link: "../assets/img/posters/poster-18.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc4",
          image_link: "../assets/img/posters/poster-19.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc4",
          image_link: "../assets/img/posters/poster-20.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc4",
          image_link: "../assets/img/posters/poster-21.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc4",
          image_link: "../assets/img/posters/poster-22.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc4",
          image_link: "../assets/img/posters/poster-23.jpg"
        },
        { building_id: "bd1", floor_id: "fl2", location_id: "lc4",
          image_link: "../assets/img/posters/poster-24.jpg"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc5",
          image_link: "../assets/img/posters/poster-25.jpg"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc5",
          image_link: "../assets/img/posters/poster-26.jpg"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc5",
          image_link: "../assets/img/posters/poster-27.jpg"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc5",
          image_link: "../assets/img/posters/poster-28.jpg"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc5",
          image_link: "../assets/img/posters/poster-29.jpg"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc5",
          image_link: "../assets/img/posters/poster-30.jpg"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc6",
          image_link: "../assets/img/posters/poster-31.jpg"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc6",
          image_link: "../assets/img/posters/poster-32.jpg"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc6",
          image_link: "../assets/img/posters/poster-33.jpg"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc6",
          image_link: "../assets/img/posters/poster-34.png"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc6",
          image_link: "../assets/img/posters/poster-35.png"
        },
        { building_id: "bd2", floor_id: "fl3", location_id: "lc6",
          image_link: "../assets/img/posters/poster-36.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc7",
          image_link: "../assets/img/posters/poster-37.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc7",
          image_link: "../assets/img/posters/poster-38.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc7",
          image_link: "../assets/img/posters/poster-39.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc7",
          image_link: "../assets/img/posters/poster-40.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc7",
          image_link: "../assets/img/posters/poster-1.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc7",
          image_link: "../assets/img/posters/poster-3.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc8",
          image_link: "../assets/img/posters/poster-5.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc8",
          image_link: "../assets/img/posters/poster-7.jpeg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc8",
          image_link: "../assets/img/posters/poster-9.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc8",
          image_link: "../assets/img/posters/poster-11.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc8",
          image_link: "../assets/img/posters/poster-13.jpg"
        },
        { building_id: "bd2", floor_id: "fl4", location_id: "lc8",
          image_link: "../assets/img/posters/poster-15.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc9",
          image_link: "../assets/img/posters/poster-17.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc9",
          image_link: "../assets/img/posters/poster-19.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc9",
          image_link: "../assets/img/posters/poster-21.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc9",
          image_link: "../assets/img/posters/poster-23.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc9",
          image_link: "../assets/img/posters/poster-25.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc9",
          image_link: "../assets/img/posters/poster-27.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc10",
          image_link: "../assets/img/posters/poster-29.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc10",
          image_link: "../assets/img/posters/poster-31.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc10",
          image_link: "../assets/img/posters/poster-33.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc10",
          image_link: "../assets/img/posters/poster-35.png"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc10",
          image_link: "../assets/img/posters/poster-37.jpg"
        },
        { building_id: "bd3", floor_id: "fl5", location_id: "lc10",
          image_link: "../assets/img/posters/poster-39.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc11",
          image_link: "../assets/img/posters/poster-2.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc11",
          image_link: "../assets/img/posters/poster-4.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc11",
          image_link: "../assets/img/posters/poster-6.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc11",
          image_link: "../assets/img/posters/poster-8.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc11",
          image_link: "../assets/img/posters/poster-10.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc11",
          image_link: "../assets/img/posters/poster-12.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc12",
          image_link: "../assets/img/posters/poster-14.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc12",
          image_link: "../assets/img/posters/poster-16.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc12",
          image_link: "../assets/img/posters/poster-18.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc12",
          image_link: "../assets/img/posters/poster-20.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc12",
          image_link: "../assets/img/posters/poster-22.jpg"
        },
        { building_id: "bd3", floor_id: "fl6", location_id: "lc12",
          image_link: "../assets/img/posters/poster-24.jpg"
        },
      ]
        
      var pos_0 = "";
      var pos_1 = "<div class=\"portfolio-item filter-x wow fadeInUp\" style=\"display: inline; width: 250px;\"> <div class=\"portfolio-wrap\"> <figure> <img src=\"";
      var pos_2 = "\" class=\"img-fluid\" alt=\"\"> <a href=\"" ;
      var pos_3 = "\" data-gall=\"portfolioGallery\" class=\"link-preview venobox\" title=\"Preview\"><i class=\"bx bx-plus\"></i></a> <a href=\"\" class=\"link-details\" title=\"More Details\"><i class=\"bx bx-link\"></i></a> </figure><div class=\"portfolio-info\"> <h4><a href=\"\">Uploader</a></h4> <p>Poster Info(?)</p> </div></div>  </div>";
      var pos_4 = "";

      $( document ).ready(function() {
        // TODO call API and get full list of posters and bfl
        // this.bfl = [];
        // this.myPosters = [];
        // console.log(bfl);
        // console.log(db);
        // console.log(db.collection("buildings").get());

        let myParams = getParams(window.location.href);
        if( getBuildingName(myParams.bid) !== "All Buildings"  ){
          selectedBuilding = myParams.bid;
        } else {
          selectedBuilding = "*";
        }
        if( getFloorName(myParams.fid) !== "All Floors" ){
          selectedFloor = myParams.fid;
        } else {
          selectedFloor = "*";
        }
        if( getLocationName(myParams.lid) !== "All Locations" ){
          selectedLocation = myParams.lid;
        } else {
          selectedLocation = "*";
        }
        setDropdowns(selectedBuilding, selectedFloor, selectedLocation);
        /*
        db.collection("establishment")
          .where("staff", "array-contains", "staff1@sunykorea.ac.kr") //get proper email later
          .get()
          .then((querySnapshot) => { 
            // console.log(querySnapshot);
            querySnapshot.forEach((doc) => {
              console.log("Establishment", doc.id, doc.data());
              db.collection("buildings")
                .where("belongs_to", "==", doc.id)
                .get()
                .then((bdQuerySnapshot) => {
                  bdQuerySnapshot.forEach((bdDoc) => {
                    console.log("Building", bdDoc.id, bdDoc.data());
                    db.collection("floors")
                      .where("belongs_to", "==", bdDoc.id)
                      .get()
                      .then((flQuerySnapshot) => {
                        flQuerySnapshot.forEach((flDoc) => {
                          console.log("Floors", flDoc.id, flDoc.data());
                          db.collection("bulletin_boards")
                            .where("belongs_to", "==", flDoc.id)
                            .get()
                            .then((bbQuerySnapshot) => {
                              bbQuerySnapshot.forEach((bbDoc) => {
                                console.log("Bulletin Board", bbDoc.id, bbDoc.data());
                              })
                            })
                            .catch(function(error) { console.log(error); });
                        })
                      })
                      .catch(function(error) { console.log(error); });
                  });
                })
                .catch(function(error) { console.log(error); });
            });
          })
          .catch(function(error) {
            console.error("Error: Could not get data", error);
          });
      });
      */
      function setDropdowns(selB, selF, selL){
        let myBuildings = "";
        let myFloors = "";
        let myLocations = "";
        myBuildings = "<div id=\"buildingDropdownBtn\" class=\"dropdown\" style=\"display: inline-block;\"> <button type=\"button\" class=\"btn btn-primary dropdown-toggle\" data-toggle=\"dropdown\">" + getBuildingName(selB) + " </button> <div class=\"dropdown-menu\"> <a class=\"dropdown-item\" href=\"javascript:setDropdowns('*', '*', '*');\">All Buildings</a>";
        if( selB !== '*' ){
          myFloors = "<div id=\"floorDropdownBtn\" class=\"dropdown\" style=\"display: inline-block;\"> <button type=\"button\" class=\"btn btn-primary dropdown-toggle\" data-toggle=\"dropdown\">" + getFloorName(selF) + "</button> <div class=\"dropdown-menu\"> <a class=\"dropdown-item\" href=\"javascript:setDropdowns('" + selB + "', '*', '*');\">All Floors</a>";
        }
        if( selF !== '*' ){
          myLocations = "<div id=\"locationropdownBtn\" class=\"dropdown\" style=\"display: inline-block;\"> <button type=\"button\" class=\"btn btn-primary dropdown-toggle\" data-toggle=\"dropdown\">" + getLocationName(selL) + "</button> <div class=\"dropdown-menu\"> <a class=\"dropdown-item\" href=\"javascript:setDropdowns('" + selB + "', '" + selF + "', '*');\">All Locations</a>";
        }
        this.bfl.forEach(b => {
          myBuildings = myBuildings + "<a class=\"dropdown-item\" href=\"javascript:setDropdowns('" + b.building_id+ "',  '*',  '*');\">" + b.building_name+"</a>";
          if( selB === b.building_id ){
            b.floors.forEach(f => {
              myFloors = myFloors + "<a class=\"dropdown-item\" href=\"javascript:setDropdowns('"+selB+"', '" + f.floor_id + "',  '*');\">" + f.floor_name + "</a>";
              if( selF === f.floor_id ){
                f.locations.forEach(l => {
                  myLocations = myLocations + "<a class=\"dropdown-item\" href=\"javascript:setDropdowns('"+selB+"', '"+selF+"', '" + l.location_id + "');\">" + l.location_name + "</a>";
                });
              }
            });
          }
        });
        myBuildings = myBuildings + "<hr><a class=\"dropdown-item\" href=\"javascript:addBuilding()\">Add New Building</a><a class=\"dropdown-item\" href=\"javascript:deleteBuilding()\">Delete Building</a></div></div>";
        if( selB !== '*' ){
          myFloors = myFloors + "<hr><a class=\"dropdown-item\" href=\"javascript:addFloor('" + selB + "')\">Add New Floor</a><a class=\"dropdown-item\" href=\"javascript:deleteFloor('" + selB + "')\">Delete Floor</a></div></div>";
        }
        if( selF !== '*' ){
          myLocations = myLocations + "<hr><a class=\"dropdown-item\" href=\"javascript:addLocation('" + selB + "','"+ selF+"')\">Add New Locations</a><a class=\"dropdown-item\" href=\"javascript:deleteLocation('" + selB + "','"+ selF+"')\">Delete Location</a></div></div>";
        }
        var ddl = $('#dropdownList');
        ddl.html( myBuildings + myFloors + myLocations );
        updatePosterItems(selB, selF, selL);
      }

      function updatePosterItems(bid, fid, lid){
        
        var loadPosters = this.pos_0;
        for( let p of this.myPosters ){
          if( !(   (bid === '*') 
                || (bid === p.building_id && fid === '*') 
                || (bid === p.building_id && fid === p.floor_id && lid === '*') 
                || (bid === p.building_id && fid === p.floor_id && lid === p.location_id) ) ){
            continue;
          }
          loadPosters = loadPosters + this.pos_1 + p.image_link + this.pos_2 + p.image_link + this.pos_3;
        }
        loadPosters = loadPosters + this.pos_4;
        var pbv = $('#posterBoardViewer');
        pbv.html(loadPosters);
      }

      function getBuildingName(bid){ 
        if( bid === '*' ){ return "All Buildings"; }
        for( let b of this.bfl ){
          if(bid === b.building_id){
            return b.building_name;
          }
        }
        return "All Buildings";
      }
      function getFloorName(fid){ 
        if( fid === '*' ){ return "All Floors"; }
        for( let b of this.bfl ){
          for( let f of b.floors ){
            if(fid === f.floor_id){
              return f.floor_name;
            }
          }
        }
        return "All Floors";
      }
      function getLocationName(lid){
        if( lid === '*' ){ return "All Locations"; }
        for( let b of this.bfl ){
          for( let f of b.floors ){
            for( let l of f.locations ){
              if(lid === l.location_id){
                return l.location_name;
              }
            }
          }
        }
        return "All Locations";
      }

      function buildingNameExists(bname){
        for( let b of this.bfl ){
          if(bname === b.building_name){
            return true;
          }
        }
        return false;
      }
      function floorNameExists(inBid, fname){
        for( let b of this.bfl ){
          if( inBid === b.building_id ){
            for( let f of b.floors ){
              if(fname === f.floor_name){
                return true;
              }
            }
          }
        }
        return false;
      }
      function locationNameExists(inBid, inFid, lname){
        for( let b of this.bfl ){
          if( inBid === b.building_id ){
            for( let f of b.floors ){
              if( inFid === f.floor_id ){
                for( let l of f.locations ){
                  if(lname === l.location_name){
                    return true;
                  }
                }
              }
            }
          }
        }
        return false;
      }

      function addBuilding(){
        let newBdName = prompt("Enter the name of the building you want to add");
        if( newBdName !== "" && newBdName !== null ){
          if( buildingNameExists(newBdName)){
            alert("Building with name \""+newBdName+"\" already exists");
          } else if( confirm("Add Building with name \:" + newBdName + "\"?" ) ){
            alert("Successfully added building with name \"" + newBdName + "\"." );
          }
        }
      }
      function addFloor( inBid ){
        let newFlName = prompt("Enter the name of the Floor you want to add");
        if( newFlName !== "" && newFlName !== null ){
          if( floorNameExists( inBid, newFlName)){
            alert("Floor with name \""+newFlName+"\" already exists");
          } else if( confirm("Add Floor with name \"" + newFlName + "\"?" ) ){
            // TODO Call database to add Floor
            alert("Successfully added a floor with name " + newFlName + "\"."  );
          }
        }
      }
      function addLocation( inBid, inFid ){
        let newLcName = prompt("Enter the name of the Location you want to add");
        if( newLcName !== "" && newLcName !== null ){
          if( locationNameExists( inBid, inFid, newLcName)){
            alert("Location with name \""+newLcName+"\" already exists");
          } else if( confirm("Add Location with name \"" + newLcName + "\"?") ){
            // TODO Call database to add Location
            alert("Successfully added a location with name " + newLcName + "\"."  );
          }
        }
      }
      function deleteBuilding(){
        let delBdName = prompt("WARNING: DELETION OF A BUILDING WILL DELETE ALL FLOORS, LOCATIONS, AND POSTERS RELATED TO THIS BUILDING\n\nEnter the name of the building you want to delete.");
        if( delBdName !== "" && delBdName !== null ){
          if( !buildingNameExists(delBdName)){
            alert("Building with name \""+delBdName+"\" does not exist");
          } else if( confirm("Confirm deletion of Building with name \"" + delBdName + "\"?" ) ){
            alert("Successfully deleted building with name \"" + delBdName + "\"." );
          }
        }
      }
      function deleteFloor( inBid ){
        let delFlName = prompt("WARNING: DELETION OF A FLOOR WILL DELETE ALL LOCATIONS AND POSTERS RELATED TO THIS FLOOR\n\nEnter the name of the floor you want to delete.");
        if( delFlName !== "" && delFlName !== null ){
          if( !floorNameExists( inBid, delFlName)){
            alert("Floor with name \""+delFlName+"\" does not exist");
          } else if( confirm("Confirm deletion of Floor with name \"" + delFlName + "\"?" ) ){
            // TODO call database to delete Floor
            alert("Successfully deleted floor with name " + delFlName + "\"."  );
          }
        }
      }
      function deleteLocation( inBid, inFid ){
        let delLcName = prompt("WARNING: DELETION OF A LOCATION WILL DELETE ALL POSTERS RELATED TO THIS LOCATION\n\nEnter the name of the location you want to delete.");
        if( delLcName !== "" && delLcName !== null ){
          if( !locationNameExists( inBid, inFid, delLcName)){
            alert("Location with name \""+delLcName+"\" does not exist");
          } else if( confirm("Confrim deletions of Location with name \"" + delLcName + "\"?") ){
            // TODO call database to delete Location
            alert("Successfully deleted location with name " + delLcName + "\"."  );
          }
        }
      }


      /**
      * Get the URL parameters
      * source: https://css-tricks.com/snippets/javascript/get-url-variables/
      * @param  {String} url The URL
      * @return {Object}     The URL parameters
      */
      var getParams = function (url) {
        var params = {};
        var parser = document.createElement('a');
        parser.href = url;
        var query = parser.search.substring(1);
        var vars = query.split('&');
        for (var i = 0; i < vars.length; i++) {
          var pair = vars[i].split('=');
          params[pair[0]] = decodeURIComponent(pair[1]);
        }
        return params;
      };

 
     
    </script>
    <script src="sidebar.js"></script>    
  </body>
</html>